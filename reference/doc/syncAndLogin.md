## 录像时

- 如果未登陆，采用本地命名,Own=LOC
- 如果已登陆，也采用本地命名,Own=LOC

## 登陆之后

- 同步
- 同步比对时，不需要上传或下载的视频，检查本地文件的命名是否为服务器命名，不是则改成服务器命名,Own改成用户
- 需要上传的视频，检查文件名是否为本地命名,如果是本地命名，在上传成功时将文件改成服务器命名，,Own改成用户
- 需要下载的视频，先检查本地是否有名称和服务器名字一样的视频，如有，检查hash，如一致，则不下载，仅在数据库注册。否则，下载后储存为服务器命名
- 同步完比对数据库记录和文件记录，删除*未注册*在数据库采用*本地命名*的冗余视频（清除中途录像停止的视频）

## 注销时

- 将用户服务器命名的文件及数据库记录，删除
- 本地命名的文件，不删除

## 登陆时

- 在登陆之后同步之前检查本地是否存在非当前用户的服务器命名的文件，有则删除

## 未登录

- 读取时，如果有服务器命名的的文件，不读取并删除

## 要求

- 不能丢失任何未同步的视频, 即便用户注销
- 用户私有的（同步之后才认为它是私有的）视频，在注销之后一定要删除
- 必须清除未被索引进数据库的本地命名的文件（产生于：录像时退出，注销瞬间杀死程序，错误的同步）
- 非本地命名的未索引文件，不需要清除